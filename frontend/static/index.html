<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Minimal To-Do List</title>
    <style>
        body { font-family: sans-serif; margin: 2em; }
        ul { padding-left: 1.2em; }
        li { margin-bottom: 0.5em; }
        input[type="text"] { padding: 0.3em; }
        button { padding: 0.3em 0.7em; }
    </style>
</head>
<body>
    <h1>To-Do List</h1>
    <input id="todo-input" type="text" placeholder="Add a new task">
    <button onclick="addItem()">Add</button>
    <ul id="todo-list"></ul>

    <script>
        const API_URL = 'http://localhost:8000';

        async function showItems() {
            const ul = document.getElementById('todo-list');
            ul.innerHTML = '';
            try {
                const res = await fetch(`${API_URL}/todos`);
                const items = await res.json();
                items.forEach(item => {
                    const li = document.createElement('li');
                    li.textContent = item.content;
                    li.onclick = () => deleteItem(item.id);
                    ul.appendChild(li);
                });
            } catch (e) {
                ul.innerHTML = '<li>Fehler beim Laden</li>';
            }
        }

        async function addItem() {
            const input = document.getElementById('todo-input');
            const text = input.value.trim();
            if (!text) return;
            await fetch(`${API_URL}/todos`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ content: text })
            });
            input.value = '';
            showItems();
        }

        async function deleteItem(id) {
            await fetch(`${API_URL}/todos/${id}`, { method: 'DELETE' });
            showItems();
        }

        document.getElementById('todo-input').addEventListener('keydown', function(e) {
            if (e.key === 'Enter') addItem();
        });

        showItems();
    </script>
</body>
</html>